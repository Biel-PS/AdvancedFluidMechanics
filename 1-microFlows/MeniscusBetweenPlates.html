
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meniscus between plates. Solution &#8212; UPC-205237 Advanced Fluid Mechanics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"Ma": "\\mathrm{Ma}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/eseiaat-positiu-p3005-interior-blanc.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UPC-205237 Advanced Fluid Mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Advanced Fluid Mechanics
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0-Intro/IntroPython.html">
   Introduction to scientific computation with Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0-Intro/Assignment0.html">
     Assignment 0: Conical tank emptying time
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Microflows.html">
   Microflows. A very brief introduction with lubrication and capillarity
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Assignment1.html">
     Assignment 1. Computation of journal bearing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2-Rheology/rheology.html">
   Rheology. A brief introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-Rheology/FDMViscoelastic.html">
     Viscoelastic fluid in a pipe (Maxwell model)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-Rheology/Assignment2.html">
     Assignment 2. Rheological behaviour of cosmetic creams
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3-Turbulence/turbulence.html">
   Turbulent flows. Statistical description and characteristic scales
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-Turbulence/ExperimentalMeasurements.html">
     Statistical process of experimental measurements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-Turbulence/Assignment3.html">
     Assignment 3 : Computation of length scales and spectrum in space
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4-BoundaryLayer/BoundaryLayer.html">
   Boundary Layer. An introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4-BoundaryLayer/Assignment4.html">
     Assignment 4. Growth of Turbulent Boundary Layer
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5-CompressibleFlow/CompressibleFlow.html">
   Compressible Flow. An introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5-CompressibleFlow/Assignment5.html">
     Assignment 5. A function to compute the flow after a deflection angle
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/rclUPC/AdvancedFluidMechanics/main?urlpath=lab/tree/1-microFlows/MeniscusBetweenPlates.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/rclUPC/AdvancedFluidMechanics/blob/main/1-microFlows/MeniscusBetweenPlates.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/1-microFlows/MeniscusBetweenPlates.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method-1">
   Method 1
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method-2-still-an-exercise-for-the-student">
   Method 2 (still an exercise for the student)
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Meniscus between plates. Solution</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method-1">
   Method 1
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method-2-still-an-exercise-for-the-student">
   Method 2 (still an exercise for the student)
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="meniscus-between-plates-solution">
<h1>Meniscus between plates. Solution<a class="headerlink" href="#meniscus-between-plates-solution" title="Permalink to this headline">#</a></h1>
<p>Find the shape for two parallels walls separated a distance <span class="math notranslate nohighlight">\(L\)</span></p>
<p>Hint: In the middle point between both walls, curvature is not zero, so there is also there a pressure jump. This pressure jump is related, then, to the height of the column, <span class="math notranslate nohighlight">\(H\)</span>. It is suggested to change coordinate axes, as shown in the picture, and change the first equation as</p>
<div class="math notranslate nohighlight">
\[ \frac{\rho g (z+H)}{\gamma} - \frac{z''}{\left(1 + {z'}^2\right)^{3/2}} = 0 \]</div>
<p>Also, there are 2 boundary conditions: the derivative of <span class="math notranslate nohighlight">\(z(x)\)</span> for <span class="math notranslate nohighlight">\(x=-\frac{L}{2}\)</span> and for <span class="math notranslate nohighlight">\(x=\frac{L}{2}\)</span></p>
<p><img alt="image.png" src="../_images/MeniscusBetweenPlates.png" /></p>
<hr class="docutils" />
<p>The exact solution of this problems can be found, both for planar and axisymmetric (capillary tube) can be found in <a class="reference external" href="https://link.springer.com/article/10.1140/epje/i2018-11648-1">this paper by Liu et al.(2018)</a>. We are going to find the shape with numerical integration, in a similar way as we have done with the shape with only one
plate.</p>
<p>We ca consider two method. In the first, we perform one integration of the second order ODE and the second is numerically integrated. In the second method, that is left as exercise, the second order ODE is written as a system of two first order ODE’s and both are numerically integrated</p>
<div class="section" id="method-1">
<h2>Method 1<a class="headerlink" href="#method-1" title="Permalink to this headline">#</a></h2>
<p>In this method the origin of <span class="math notranslate nohighlight">\(x\)</span> is at the wall and the numerical integration is done until the middle point between plates. All the variables are normalized with capillary length
<span class="math notranslate nohighlight">\( l_s = \sqrt{\frac{\gamma}{\rho g}} \)</span>. Hence,</p>
<p>\begin{eqnarray}
\xi &amp;=&amp; \frac{x}{l_s} \
\eta &amp;=&amp; \frac{z}{l_s} \
\beta &amp;=&amp; \frac{H}{l_s} \
\lambda &amp;=&amp; \frac{L}{l_s}
\end{eqnarray}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span><span class="n">Math</span>
<span class="n">sp</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xi</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;xi,theta,beta&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;eta&#39;</span><span class="p">)</span>
<span class="n">exp</span> <span class="o">=</span> <span class="p">(</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">+</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;= 0&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \beta - \frac{\frac{d^{2}}{d \xi^{2}} \eta{\left(\xi \right)}}{\left(\left(\frac{d}{d \xi} \eta{\left(\xi \right)}\right)^{2} + 1\right)^{1.5}} + \eta{\left(\xi \right)}= 0\]</div>
</div>
</div>
<p>As in the case of one plate, this equation can be integrated with an integration factor <span class="math notranslate nohighlight">\(\eta'\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span><span class="o">*</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;= 0&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left(\beta - \frac{\frac{d^{2}}{d \xi^{2}} \eta{\left(\xi \right)}}{\left(\left(\frac{d}{d \xi} \eta{\left(\xi \right)}\right)^{2} + 1\right)^{1.5}} + \eta{\left(\xi \right)}\right) \frac{d}{d \xi} \eta{\left(\xi \right)}= 0\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp2</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">exp2</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;= \text</span><span class="si">{constant}</span><span class="s1">&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \beta \eta{\left(\xi \right)} + \frac{1.0}{\left(\left(\frac{d}{d \xi} \eta{\left(\xi \right)}\right)^{2} + 1\right)^{0.5}} + \frac{\eta^{2}{\left(\xi \right)}}{2}= \text{constant}\]</div>
</div>
</div>
<p>Again, when <span class="math notranslate nohighlight">\(\eta=0\)</span>, the first derivative is <span class="math notranslate nohighlight">\(0\)</span> too, so, this is again 1. And <span class="math notranslate nohighlight">\(\delta\)</span>, the normalized height of water in the wall (above center of meniscus) can be calculated by imposing its derivative.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dEq</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">exp2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">dEq</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;delta&#39;</span><span class="p">)</span>
<span class="n">deltaEq</span> <span class="o">=</span> <span class="n">dEq</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xi</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">),</span><span class="n">delta</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">deltaEq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/MeniscusBetweenPlates_7_0.png" src="../_images/MeniscusBetweenPlates_7_0.png" />
<img alt="../_images/MeniscusBetweenPlates_7_1.png" src="../_images/MeniscusBetweenPlates_7_1.png" />
</div>
</div>
<p>We keep the second solution, which is the positive one</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deltaSol</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">deltaEq</span><span class="p">,</span><span class="n">delta</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">deltaSol</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="s1">&#39;\delta =&#39;</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">deltaSol</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \delta =- \beta + \frac{1.4142135623731 \sqrt{0.5 \beta^{2} \left|{\cos{\left(\theta \right)}}\right| - \cos^{2}{\left(\theta \right)} \left|{\tan{\left(\theta \right)}}\right| + \left|{\cos{\left(\theta \right)}}\right|} \left|{\tan{\left(\theta \right)}}\right|}{\tan{\left(\theta \right)} \left|{\sqrt{\cos{\left(\theta \right)}}}\right|}\]</div>
</div>
</div>
<p>This is function of the contact angle (<span class="math notranslate nohighlight">\(\theta\)</span>) but also of the height of the column, <span class="math notranslate nohighlight">\(\beta\)</span>. The higher is <span class="math notranslate nohighlight">\(\beta\)</span>, the lower is <span class="math notranslate nohighlight">\(\delta\)</span>. This is because also <span class="math notranslate nohighlight">\(\lambda\)</span> will be lower, and the meniscus is narrower.</p>
<p>We construct a function to calculate the numerical value of <span class="math notranslate nohighlight">\(\delta\)</span> (initial value of <span class="math notranslate nohighlight">\(\eta\)</span>) with <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eta0_n</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">beta</span><span class="p">,</span><span class="n">theta</span><span class="p">),</span><span class="n">deltaSol</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>and also, we construct the first order that we want to integrate, by defining the first derivative of <span class="math notranslate nohighlight">\(\eta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">dEq</span><span class="p">,</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xi</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\frac{\text</span><span class="si">{d}</span><span class="s1">\eta}{\text</span><span class="si">{d}</span><span class="s1">\xi} =&#39;</span><span class="o">+</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{\text{d}\eta}{\text{d}\xi} =- \sqrt{-1.0 + \frac{1.0}{\left(\beta \eta{\left(\xi \right)} + 0.5 \eta^{2}{\left(\xi \right)} - 1\right)^{2}}}\]</div>
</div>
</div>
<p>and its numerical version</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deta_dxi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">xi</span><span class="p">,</span><span class="n">eta</span><span class="p">(</span><span class="n">xi</span><span class="p">),</span><span class="n">beta</span><span class="p">),</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>and now we can integrate it, choosing input values for contact angle <span class="math notranslate nohighlight">\(\theta\)</span> and for <span class="math notranslate nohighlight">\(\beta\)</span> (height of column). The function used to numerically the EDO is <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code> (for <em>Initial Value Problem</em>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="n">theta_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">beta_n</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">eta0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">eta0_n</span><span class="p">(</span><span class="n">beta_n</span><span class="p">,</span><span class="n">theta_n</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">eta0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/MeniscusBetweenPlates_17_0.png" src="../_images/MeniscusBetweenPlates_17_0.png" />
</div>
</div>
<p>An estimation of distance between plates can be done easily with the circular approximation, yielding <span class="math notranslate nohighlight">\(\lambda = \frac{2\cos{\theta}}{\beta}\)</span>. So, the distance to the middle point will be less than <span class="math notranslate nohighlight">\(\frac{\cos{\theta}}{\beta}\)</span>. This distance can also be computed assuimint that <span class="math notranslate nohighlight">\(\eta(\xi) = 0 \; \forall \; \xi\)</span> and the weigth of the column is only due to the liquid mass below <span class="math notranslate nohighlight">\(z=0\)</span>.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code> takes 3 main arguments:</p>
<ul class="simple">
<li><p>The function defining the derivative of <span class="math notranslate nohighlight">\(\eta\)</span> (in our case, deta_dxi) that has to be as f(t,x(t)) (Note the the first argument as to be the independent variable, <span class="math notranslate nohighlight">\(t\)</span> or <span class="math notranslate nohighlight">\(\xi\)</span> and the second the function to be computed, <span class="math notranslate nohighlight">\(y(t)\)</span>, or <span class="math notranslate nohighlight">\(\eta(\xi)\)</span>.</p></li>
<li><p>The interval of computation.</p></li>
<li><p>The initial value or values.</p></li>
</ul>
<p>The other arguments are the points where we want the function to be evaluated and the extra parameter that has to be passed to the function deta_dxi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l_2_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_n</span><span class="p">)</span><span class="o">/</span><span class="n">beta_n</span>
<span class="n">xi_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">l_2_est</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># long enough for our case</span>
<span class="n">sol_eta</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">deta_dxi</span><span class="p">,(</span><span class="n">xi_p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xi_p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),[</span><span class="n">eta0</span><span class="p">],</span><span class="n">t_eval</span><span class="o">=</span><span class="n">xi_p</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">beta_n</span><span class="p">,))</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lambdifygenerated-2&gt;:2: RuntimeWarning: invalid value encountered in sqrt
  return -sqrt(-1.0 + 1.0/(0.5*_Dummy_2602**2 + _Dummy_2602*beta - 1)**2)
</pre></div>
</div>
</div>
</div>
<p>It can ouput a warning because the derivative can gives imaginary values (negative argument in the root square) but it is not important.</p>
<p>The real value of <span class="math notranslate nohighlight">\(\lambda\)</span> is obtained by computing the real weigth of the column and equating it to the surface tension. In dimensionless form, it is written as
$<span class="math notranslate nohighlight">\(  \int_0^{\lambda/2}\eta(\xi)\text{d}\xi + \beta \frac{\lambda}{2} = \cos(\theta) \)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\( \Rightarrow \; \frac{\lambda}{2} = \frac{1}{\beta}\left(\cos(\theta) - \int_0^{\lambda/2}\eta(\xi)\text{d}\xi \right) \)</span>$</p>
<p>Don’t worry about the limit of integration in <span class="math notranslate nohighlight">\(\eta(\xi)\)</span>, since <span class="math notranslate nohighlight">\(\eta(\xi) = 0\)</span> for <span class="math notranslate nohighlight">\(\xi&gt;\lambda/2\)</span>. So, the integration can be done in all the computed interval.</p>
<p><code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code> outputs more information than just the solution</p>
<p>The evaluation points are stored in <code class="docutils literal notranslate"><span class="pre">sol_eta.t</span></code>, and the solution in <code class="docutils literal notranslate"><span class="pre">sol_eta.y</span></code> that is, actually an array of arrays and, in our case, we have only one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eta_np</span> <span class="o">=</span> <span class="n">sol_eta</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xi_np</span> <span class="o">=</span> <span class="n">sol_eta</span><span class="o">.</span><span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_n</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">eta_np</span><span class="p">,</span><span class="n">xi_np</span><span class="p">))</span><span class="o">/</span><span class="n">beta_n</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;numerical value for lambda: </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l_2</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;estimated value for lambda: </span><span class="si">{:.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l_2_est</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numerical value for lambda: 5.59
estimated value for lambda: 17.3
</pre></div>
</div>
</div>
</div>
<p>We keep only the values corresponding to <span class="math notranslate nohighlight">\(\xi &lt; \lambda/2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xi_np</span> <span class="o">=</span> <span class="n">xi_np</span><span class="p">[</span><span class="n">sol_eta</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">l_2</span><span class="p">]</span> <span class="c1"># [xi_np &lt; l_2] indentifies the indexes where the condition is fulfilled</span>
<span class="n">eta_np</span> <span class="o">=</span> <span class="n">eta_np</span><span class="p">[</span><span class="n">sol_eta</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">l_2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">l_2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_n</span><span class="p">)</span>
<span class="n">eta_circ</span> <span class="o">=</span> <span class="n">R</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">l_2</span><span class="o">-</span><span class="n">xi_np</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi_np</span><span class="p">,</span><span class="n">eta_np</span><span class="p">,</span><span class="n">scaley</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi_np</span><span class="p">,</span><span class="n">eta_circ</span><span class="p">,</span><span class="n">scaley</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span><span class="s1">&#39;cercle&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f4a082a7ac0&gt;
</pre></div>
</div>
<img alt="../_images/MeniscusBetweenPlates_30_1.png" src="../_images/MeniscusBetweenPlates_30_1.png" />
</div>
</div>
</div>
<div class="section" id="method-2-still-an-exercise-for-the-student">
<h2>Method 2 (still an exercise for the student)<a class="headerlink" href="#method-2-still-an-exercise-for-the-student" title="Permalink to this headline">#</a></h2>
<p>In this method, we write the second order ODE as a system of two first order ODE’s:</p>
<div class="math notranslate nohighlight">
\[
\zeta'(\zeta,\eta,\xi) = (\eta(\xi) + \beta)\left(1+\zeta(\xi)^2\right)^\frac{3}{2}
\]</div>
<div class="math notranslate nohighlight">
\[
\eta'(\zeta,\eta,\xi) = \zeta(\xi)
\]</div>
<p>and, if the coordinates are centered in the middle point (as indicated in the figure), the initial conditions are <span class="math notranslate nohighlight">\(\eta(\xi=0)=\zeta(\xi=0)=0\)</span>.</p>
<p><em>Question:</em> How do we calculate the value of <span class="math notranslate nohighlight">\(\lambda\)</span>?</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./1-microFlows"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Robert Castilla - UPC CATMech Terrassa<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rheology. A brief introduction &#8212; UPC-205237 Advanced Fluid Mechanics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"Ma": "\\mathrm{Ma}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Viscoelastic fluid in a pipe (Maxwell model)" href="FDMViscoelastic.html" />
    <link rel="prev" title="Assignment 1. Computation of journal bearing" href="../1-microFlows/Assignment1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/eseiaat-positiu-p3005-interior-blanc.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UPC-205237 Advanced Fluid Mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Advanced Fluid Mechanics
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0-Intro/IntroPython.html">
   Introduction to scientific computation with Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0-Intro/Assignment0.html">
     Assignment 0: Conical tank emptying time
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1-microFlows/Microflows.html">
   Microflows. A very brief introduction with lubrication and capillarity
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1-microFlows/Assignment1.html">
     Assignment 1. Computation of journal bearing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   Rheology. A brief introduction
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="FDMViscoelastic.html">
     Viscoelastic fluid in a pipe (Maxwell model)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Assignment2.html">
     Assignment 2. Rheological behaviour of cosmetic creams
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3-Turbulence/turbulence.html">
   Turbulent flows. Statistical description and characteristic scales
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-Turbulence/ExperimentalMeasurements.html">
     Statistical process of experimental measurements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-Turbulence/Assignment3.html">
     Assignment 3 : Computation of length scales and spectrum in space
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4-BoundaryLayer/BoundaryLayer.html">
   Boundary Layer. An introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4-BoundaryLayer/Assignment4.html">
     Assignment 4. Growth of Turbulent Boundary Layer
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5-CompressibleFlow/CompressibleFlow.html">
   Compressible Flow. An introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5-CompressibleFlow/Assignment5.html">
     Assignment 5. A function to compute the flow after a deflection angle
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/2-Rheology/rheology.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rclUPC/AdvancedFluidMechanics/main?urlpath=lab/tree/2-Rheology/rheology.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/rclUPC/AdvancedFluidMechanics/blob/main/2-Rheology/rheology.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#classification-of-fluids">
   1. Classification of fluids
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalized-newtonian-fluids">
   2. Generalized Newtonian Fluids
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#power-law-fluid-in-a-pipe">
     Power Law Fluid in a pipe
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-of-the-velocity-profile">
     Plot of the velocity profile
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     Exercise 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3">
     Exercise 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viscoelastic-fluids">
   3. Viscoelastic fluids
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maxwell-element">
     Maxwell element
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#voigth-kelvin-element">
     Voigth-Kelvin element
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jeffreys-burger-element">
     Jeffreys-Burger element
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extension-to-vectorial-notation">
     Extension to vectorial notation
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Rheology. A brief introduction</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#classification-of-fluids">
   1. Classification of fluids
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalized-newtonian-fluids">
   2. Generalized Newtonian Fluids
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#power-law-fluid-in-a-pipe">
     Power Law Fluid in a pipe
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-of-the-velocity-profile">
     Plot of the velocity profile
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     Exercise 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3">
     Exercise 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viscoelastic-fluids">
   3. Viscoelastic fluids
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maxwell-element">
     Maxwell element
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#voigth-kelvin-element">
     Voigth-Kelvin element
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jeffreys-burger-element">
     Jeffreys-Burger element
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extension-to-vectorial-notation">
     Extension to vectorial notation
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="rheology-a-brief-introduction">
<h1>Rheology. A brief introduction<a class="headerlink" href="#rheology-a-brief-introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classification-of-fluids">
<h2>1. Classification of fluids<a class="headerlink" href="#classification-of-fluids" title="Permalink to this headline">¶</a></h2>
<p>This notebook is based principally on the <a class="reference external" href="https://discovery.upc.edu/permalink/34CSUC_UPC/rdgucl/alma991001402139706711">book by Irgens</a> and also on the classical <a class="reference external" href="https://discovery.upc.edu/iii/encore/record/C__Rb1230696?lang=cat">book by Bird</a>. Also chapter chapter 7 in the book of <a class="reference external" href="https://discovery.upc.edu/permalink/34CSUC_UPC/19srfpi/cdi_askewsholts_vlebooks_9781402067426">Engineerign Fluid Mechanics, by H. Yamaguchi</a> has been used.</p>
<p>Very briefly, when we have studied Fluid Mechanics, we have focused on fluids that meet Newton’s law for shear stress,</p>
<div class="math notranslate nohighlight">
\[ \tau = \mu \dot\gamma \tag{1}\]</div>
<p>for 2-D flow, where <span class="math notranslate nohighlight">\(\tau\)</span> is the shear stres, <span class="math notranslate nohighlight">\(\dot\gamma\)</span> is the shear rate. <span class="math notranslate nohighlight">\(\mu\)</span> is the <em>dynamic viscosity</em>, or just <em>viscosity</em>, of the fluid.</p>
<p>Water, air and other molecularly simple fluids obey this law. But most of the liquids do not. <a class="reference external" href="https://en.wikipedia.org/wiki/Rheology">Rheology</a> is the branch of science and technology that studies this kind of non-linear behaviour, both in solids and in fluids. We are focusing in this part in the rheology of fluids.</p>
<p>A fluid is called <em>pure viscous</em> if the shear rate is only function of shear stress</p>
<div class="math notranslate nohighlight">
\[ \tau = f(\dot\gamma) \tag{2}\]</div>
<p>This function can be linear in the case of <strong>Newtonian fluids</strong> or non-linear in the case of <strong>non Newtonian fluids</strong> (also known as rheological fluids).</p>
<p>In general, for pure viscous fluids, an <em>apparent viscosity</em> can be defined as</p>
<div class="math notranslate nohighlight">
\[ \mu (\dot\gamma) = \frac{\tau}{\dot\gamma} \tag{3}\]</div>
<p>The most common model is the <strong>Generalized Newtonian Fluids</strong>, that is modeled with the <a class="reference external" href="https://en.wikipedia.org/wiki/Power-law_fluid"><strong>power law</strong></a>, also known as Ostwald-de Waele law, where shear stress is modelled as</p>
<div class="math notranslate nohighlight">
\[ \tau = K \dot\gamma^n \tag{4}\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[ \mu(\dot\gamma) = K (\dot{\gamma})^{n-1} \tag{5}\]</div>
<p><span class="math notranslate nohighlight">\(K\)</span> is the <em>consistency parameter</em> and <span class="math notranslate nohighlight">\(n\)</span> is the power law index</p>
<ul class="simple">
<li><p>When <span class="math notranslate nohighlight">\(n = 1\)</span> the fluid is Newtonian and <span class="math notranslate nohighlight">\(K\)</span> is just its viscosity</p></li>
<li><p>When <span class="math notranslate nohighlight">\(n &lt; 1\)</span> apparent viscosity decreases with shear rate and the fluid is classified as <em>pseudoplastic</em> or <a class="reference external" href="https://en.wikipedia.org/wiki/Shear_thinning"><em>shear thinning</em></a>. Most non-Newtonian fluids are of this type, like paints, <a class="reference external" href="http://www.maths.gla.ac.uk/~xl/Arasu-biofluid.pdf">blood</a>, and most of food liquids (juices, creams, soups,…)</p></li>
<li><p>When <span class="math notranslate nohighlight">\(n &gt; 1\)</span> apparent viscosity increases with shear rate and the fluid is known as dilatant or <a class="reference external" href="https://en.wikipedia.org/wiki/Dilatant#Examples"><em>shear thickening</em></a>. This is much less common, and the typical example is the cornstarch (maicena) which allow <a class="reference external" href="https://www.youtube.com/watch?v=q-DZ0f0_NCA">funny experiments</a></p></li>
</ul>
<p><img alt="image.png" src="../_images/powerLawRheogram.png" /></p>
<p>Other type of behavior is the <a class="reference external" href="https://en.wikipedia.org/wiki/Viscoplasticity"><strong>viscoplastic fluid</strong></a> that behave as solid for a shear stress lower than a limit value, known as <em>yield shear stress</em>, and as a fluid fow larger values of the shear stress.</p>
<p><img alt="image.png" src="../_images/BinghamRheogram.png" /></p>
<p>The most simple model is the <a class="reference external" href="https://en.wikipedia.org/wiki/Bingham_plastic"><em>Bingham fluid</em></a> (<a class="reference external" href="https://en.wikipedia.org/wiki/Eugene_C._Bingham">Bingham</a> was the inventor of the name “Rheology”). Theses fluids behave like newtonian for shear stress larger than the yield shear stress. This model is tipycally used for toothpaste, mud or slurries. It is mathematically modeled as</p>
<div class="math notranslate nohighlight">
\[ \tau(\dot\gamma) = \tau_y + \mu \dot\gamma \tag{6}\]</div>
<p>There are also some <strong>Time Dependent</strong> models as <a class="reference external" href="https://en.wikipedia.org/wiki/Thixotropy"><em>Thixotropic fluids</em></a> when shear stress decreases in time for a constant shear rate, and <a class="reference external" href="https://en.wikipedia.org/wiki/Rheopecty"><em>Rheopectic fluids</em></a> otherwise. These kind of fluids are beyond the scope of this course</p>
</div>
<div class="section" id="generalized-newtonian-fluids">
<h2>2. Generalized Newtonian Fluids<a class="headerlink" href="#generalized-newtonian-fluids" title="Permalink to this headline">¶</a></h2>
<div class="section" id="power-law-fluid-in-a-pipe">
<h3>Power Law Fluid in a pipe<a class="headerlink" href="#power-law-fluid-in-a-pipe" title="Permalink to this headline">¶</a></h3>
<p>Let’s consider a very slow flow and/or very small, so that inertial and time terms can be neglected.</p>
<p>We have seen in Fluid Mechanics that for a Newtonian Fluid, <a class="reference external" href="https://en.wikipedia.org/wiki/Hagen%E2%80%93Poiseuille_equation#Derivation">Hagen-Poiseuille law</a> holds, according to the Navier Stokes equation for a laminar, viscous flow</p>
<div class="math notranslate nohighlight">
\[
0 =  -\frac{\partial p}{\partial z} + \frac{1}{r}\frac{\partial}{\partial r}\left(r \tau_{rz}\right) \tag{7}
\]</div>
<p>giving a paraboloid velocity profile and a flowrate</p>
<div class="math notranslate nohighlight">
\[ Q = \frac{\Delta p \pi R^4}{8\mu L} \tag{8}\]</div>
<p>provided that, as a Newtonian fluid, <span class="math notranslate nohighlight">\(\tau_{rz} = \mu \dot\gamma = \mu \frac{\partial u_z}{\partial r} \)</span>.</p>
<p>Now, with a Power Law Fluid, <span class="math notranslate nohighlight">\(\tau_{rz} = K(\dot\gamma)^n\)</span>, it leads to</p>
<div class="math notranslate nohighlight">
\[ \frac{\text{d} u_z}{\text{d}r} = \left[ \frac{1}{2K}\left(\frac{\text{d}p}{\text{d}z}\right)r\right]^\frac{1}{n} = \left[ \frac{1}{2K}\left(-\frac{\Delta p}{L}\right)r\right]^\frac{1}{n} \tag{9} \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">sp</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span><span class="p">,</span><span class="n">Deltap</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;K {\Delta}p L r n R&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">uz</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;uz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Eq</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">uz</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">r</span><span class="p">),(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Deltap</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">Eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_3_0.png" src="../_images/rheology_3_0.png" />
</div>
</div>
<p>First, we integrate it and try to simplify it a little bit …</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Deltap</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uz</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">exp</span><span class="p">,(</span><span class="n">r</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uz</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_7_0.png" src="../_images/rheology_7_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uz</span> <span class="o">=</span> <span class="n">uz</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">powsimp</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">uz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_8_0.png" src="../_images/rheology_8_0.png" />
</div>
</div>
<p>… just to integrate it again and obtain the flow rate in the pipe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">uz</span><span class="o">*</span><span class="n">r</span><span class="p">,(</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">powsimp</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_10_0.png" src="../_images/rheology_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_11_0.png" src="../_images/rheology_11_0.png" />
</div>
</div>
<p>and, from here, the average velocity, so that we can normalize velocity profile</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_avg</span> <span class="o">=</span> <span class="n">Q</span><span class="o">/</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">u_avg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_13_0.png" src="../_images/rheology_13_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_dimless</span> <span class="o">=</span> <span class="n">uz</span><span class="o">/</span><span class="n">u_avg</span>
<span class="n">u_dimless</span> <span class="o">=</span> <span class="n">u_dimless</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">u_dimless</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_14_0.png" src="../_images/rheology_14_0.png" />
</div>
</div>
<p>In order to get it in dimensionless form, we just impose <span class="math notranslate nohighlight">\(R=1\)</span> so that now <span class="math notranslate nohighlight">\(r\)</span> is the dimensionless radius <span class="math notranslate nohighlight">\(0&lt;r/R&lt;1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_dimless</span> <span class="o">=</span> <span class="n">u_dimless</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">u_dimless</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_16_0.png" src="../_images/rheology_16_0.png" />
</div>
</div>
</div>
<div class="section" id="plot-of-the-velocity-profile">
<h3>Plot of the velocity profile<a class="headerlink" href="#plot-of-the-velocity-profile" title="Permalink to this headline">¶</a></h3>
<p>We are now plotting this dimensionless profile in order to see the effect of the parameter <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>First we <em>lambdify</em> the expression (that is, remember, to convert it to a numerical function of two variables in this case)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_np</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">r</span><span class="p">),</span><span class="n">u_dimless</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_np</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span> <span class="c1"># Just to check it</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_19_0.png" src="../_images/rheology_19_0.png" />
</div>
</div>
<p>Now the <a class="reference external" href="https://ipywidgets.readthedocs.io/en/latest/">ipywidgets</a> module is used. It is very useful to make interactive widgets. It only works in a dynamic environment, with a kernel; so you have to download the notebook and run it in Jupyterlab or Google Colaborative.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u_np</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u_np</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$n=1$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">interactive_plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mf">0.01</span><span class="p">))</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">interactive_plot</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">output</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s1">&#39;350px&#39;</span>
<span class="n">interactive_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3e0048e478a44d40adbdd0b3e8355545"}
</script></div>
</div>
</div>
<div class="section" id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<p>Check that dimensionless flowrate is independent of <span class="math notranslate nohighlight">\(n\)</span>. What is its value?</p>
</div>
<div class="section" id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>Reynolds number for power law fluids is defined differently than for a Newtonian fluid. Provided that the dimensionless stress <span class="math notranslate nohighlight">\(\tau^*\)</span> should be written in terms of a dimensionless strain rate <span class="math notranslate nohighlight">\(\gamma^*\)</span> as</p>
<div class="math notranslate nohighlight">
\[ \tau^* = \frac{1}{\text{Re}_n}\left(\gamma^*\right)^n \]</div>
<p>Find the definition of <span class="math notranslate nohighlight">\(\text{Re}_n\)</span></p>
<p>This number defines the similarity when experiments with two different power law fluids are performed.</p>
</div>
<div class="section" id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Permalink to this headline">¶</a></h3>
<p>As an exercise for this topic, it is proposed to make a similar study: the laminar velocity profile in a pipe for a Bingham plastic</p>
</div>
</div>
<div class="section" id="viscoelastic-fluids">
<h2>3. Viscoelastic fluids<a class="headerlink" href="#viscoelastic-fluids" title="Permalink to this headline">¶</a></h2>
<p>This is a complicated topic. Several constitutive equations have been proposed according to experimental results. Viscoelastic materials have both viscous and elastic behavior. Some examples are rubbers, melted glass and also some complex biofluids, as cytoplasm.</p>
<p>Most of the cases in engineering can only be solved with CFD, due to the high non-linearity between constitutive equations, continuity and momentum balance. Here we are only focusing in simple cases with linear viscoelastic flows.</p>
<p>In general, constitutive equations for linear viscoelastic material are linear relationship between shear stress, shear rate and its time derivative.</p>
<div class="math notranslate nohighlight">
\[ f(\tau, \frac{\text{d}^n \tau}{\text{d}t^n},\gamma, \frac{\text{d}^n \gamma}{\text{d}t^n}) = \sum_{n=0}^{N} \left( a_n \frac{\text{d}^n \tau}{\text{d}t^n} + b_n \frac{\text{d}^n \gamma}{\text{d}t^n}\right)= 0\]</div>
<div class="section" id="maxwell-element">
<h3>Maxwell element<a class="headerlink" href="#maxwell-element" title="Permalink to this headline">¶</a></h3>
<p>The most fundamental model is the so-called <strong>Maxwell element</strong>, composed of a combination in series of a viscous element, with viscosity <span class="math notranslate nohighlight">\(\eta\)</span> and a spring, with constant <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p><img alt="Image" src="../_images/Maxwell.png" /></p>
<p>In this case, both stresses are the same, <span class="math notranslate nohighlight">\(\tau_1= \tau_2\)</span>, and the displacements<span class="math notranslate nohighlight">\(\gamma\)</span> are additive, <span class="math notranslate nohighlight">\(\gamma = \gamma_1 +\gamma_2\)</span>. By deriving this last expression an arranging terms, we get</p>
<div class="math notranslate nohighlight">
\[ \tau + \lambda \dot\tau = \eta \dot\gamma \]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda = \frac{\eta}{G}\)</span> is the <em>relaxation time</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">eta</span><span class="p">,</span><span class="n">G</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;eta,G&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">)</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">)</span>
<span class="n">gammaDot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;gammaDot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">eta</span><span class="o">/</span><span class="n">G</span><span class="o">*</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">eta</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_28_0.png" src="../_images/rheology_28_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#tauInf = sp.symbols(&#39;\\tau_{-\infty}&#39;)</span>
<span class="c1">#tauSol = sp.dsolve(eq,tau(t),ics={tau(-sp.oo):tauInf})</span>
<span class="n">tauSol</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The following commands have been tested with <code class="docutils literal notranslate"><span class="pre">sympy</span> <span class="pre">1.7.1</span></code>. Newer versions are not working properly</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tauSol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_31_0.png" src="../_images/rheology_31_0.png" />
</div>
</div>
<p>Let’s consider a first example in which <span class="math notranslate nohighlight">\(\gamma(t)\)</span> is a <a class="reference external" href="https://en.wikipedia.org/wiki/Step_function">step function</a> with <span class="math notranslate nohighlight">\(\gamma = 1\)</span> for <span class="math notranslate nohighlight">\(t&lt;0\)</span> and then it is imposed as <span class="math notranslate nohighlight">\(\gamma = 0\)</span> again for positive time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tauStep</span> <span class="o">=</span> <span class="n">tauSol</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)))</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">tauStep</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_33_0.png" src="../_images/rheology_33_0.png" />
</div>
</div>
<p>That is, stress is relaxed in time according to the value of viscosity and spring constant. Note that, in general, the value of the stress is not only function of <span class="math notranslate nohighlight">\(\gamma\)</span> and its derivative but also, <em>of its history</em>.</p>
<p><span class="math notranslate nohighlight">\(G e^{-\frac{t}{\lambda}}\)</span> is the <em>relaxation modulus</em>.</p>
<p>We could also write the expression for <span class="math notranslate nohighlight">\(\tau(t)\)</span> in terms of <span class="math notranslate nohighlight">\(\gamma\)</span> instead of <span class="math notranslate nohighlight">\(\dot\gamma\)</span> by integrating by parts, and then we could obtain</p>
<p><span class="math notranslate nohighlight">\(\tau(t) = - \int \frac{\eta}{\lambda^2}e^{-\frac{t}{\lambda}} \gamma(t) dt\)</span></p>
<p>and the function <span class="math notranslate nohighlight">\(M(t) = \frac{\eta}{\lambda^2}e^{-\frac{t}{\lambda}}\)</span> is called the <em>memory function</em></p>
<p>Let’s now consider that we impose to shear an harmonic constraint</p>
<div class="math notranslate nohighlight">
\[ \gamma(t) = a\sin(\omega t) \]</div>
<p>and we can measure stress.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;omega,a&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tauSin</span> <span class="o">=</span> <span class="n">tauSol</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">a</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">tauSin</span> <span class="o">=</span> <span class="n">tauSin</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">tauSin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_36_0.png" src="../_images/rheology_36_0.png" />
</div>
</div>
<p>After a while, when relaxation time has passed, the first term, <span class="math notranslate nohighlight">\(C_1 e^{-\frac{Gt}{\eta}}\)</span>, can be neglected</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tauSinInf</span><span class="o">=</span><span class="n">tauSin</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tauSin</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tauSinInf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">IndexError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">Input In [26],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">tauSinInf</span><span class="o">=</span><span class="n">tauSin</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tauSin</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">display</span><span class="p">(</span><span class="n">tauSinInf</span><span class="p">)</span>

<span class="ne">IndexError</span>: tuple index out of range
</pre></div>
</div>
</div>
</div>
<p>The modulus that multiplies the sinus term is known as <span class="math notranslate nohighlight">\(G'\)</span>, the <strong>storage modulus</strong>, and measures the ability of the fluid to store elastic energy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GPrime1</span><span class="p">,</span><span class="n">GPrime2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;G</span><span class="se">\&#39;</span><span class="s1">,G</span><span class="se">\&#39;\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GPrime1</span> <span class="o">=</span> <span class="n">tauSinInf</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">GPrime1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_41_0.png" src="../_images/rheology_41_0.png" />
</div>
</div>
<p>The modulus that multiplies the cosinus term is known as <span class="math notranslate nohighlight">\(G''\)</span>, the <strong>loss modulus</strong>, and measures the ability of the fluid to lose energy through viscous dissipation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GPrime2</span> <span class="o">=</span> <span class="n">tauSinInf</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">GPrime2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_43_0.png" src="../_images/rheology_43_0.png" />
</div>
</div>
<p>We can write this moduli in terms of characteristic time (let me use here <span class="math notranslate nohighlight">\(t_c\)</span> since <span class="math notranslate nohighlight">\(\lambda\)</span> confuses python with the <code class="docutils literal notranslate"><span class="pre">lambda</span></code> function)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tc</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t_c&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">GPrime1</span> <span class="o">=</span> <span class="n">GPrime1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">tc</span><span class="o">*</span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">GPrime2</span> <span class="o">=</span> <span class="n">GPrime2</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">tc</span><span class="o">*</span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">GPrime1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">GPrime2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_45_0.png" src="../_images/rheology_45_0.png" />
<img alt="../_images/rheology_45_1.png" src="../_images/rheology_45_1.png" />
</div>
</div>
<p>We can estimate the behavior of this two parameters as function of the frequency <span class="math notranslate nohighlight">\(\omega\)</span> of the experiment, using the dimensionless time <span class="math notranslate nohighlight">\(\epsilon = \omega t_c\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;epsilon&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">GPrime1</span> <span class="o">=</span> <span class="n">GPrime1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span><span class="n">epsilon</span><span class="o">/</span><span class="n">tc</span><span class="p">)</span>
<span class="n">GPrime2</span> <span class="o">=</span> <span class="n">GPrime2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span><span class="n">epsilon</span><span class="o">/</span><span class="n">tc</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">GPrime1</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">GPrime2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_47_0.png" src="../_images/rheology_47_0.png" />
<img alt="../_images/rheology_47_1.png" src="../_images/rheology_47_1.png" />
</div>
</div>
<p>Let’s plot it…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GPrime1_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span><span class="n">GPrime1</span><span class="o">/</span><span class="n">G</span><span class="p">)</span>
<span class="n">GPrime2_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span><span class="n">GPrime2</span><span class="o">/</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GPrime1_values</span> <span class="o">=</span> <span class="n">GPrime1_f</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
<span class="n">GPrime2_values</span> <span class="o">=</span> <span class="n">GPrime2_f</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">GPrime1_values</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$G^\prime$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">GPrime2_values</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$G^{\prime\prime} $&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">GPrime1_values</span><span class="o">+</span><span class="n">GPrime2_values</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$G^\prime + G^{\prime\prime} $&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega t_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f3d3ef33370&gt;
</pre></div>
</div>
<img alt="../_images/rheology_53_1.png" src="../_images/rheology_53_1.png" />
</div>
</div>
<p>The value of <span class="math notranslate nohighlight">\(\tau\)</span> for large <span class="math notranslate nohighlight">\(\omega\)</span> gives <span class="math notranslate nohighlight">\(G^\prime\)</span>, the storage modulus. The slope of the curve for small <span class="math notranslate nohighlight">\(\omega\)</span> allows the estimation of <span class="math notranslate nohighlight">\(G^{\prime\prime}\)</span> the loss modulus and, hence, the viscous component of the fluid. That is the fundamentals of the <a class="reference external" href="http://www.mate.tue.nl/~wyss/home/resources/publications/2007/Wyss_GIT_Lab_J_2007.pdf">oscillatory rheometers</a></p>
</div>
<div class="section" id="voigth-kelvin-element">
<h3>Voigth-Kelvin element<a class="headerlink" href="#voigth-kelvin-element" title="Permalink to this headline">¶</a></h3>
<p>However, Maxwell model does not explain most of the viscoelastic behavior. Another option is the  Voigth, or Kelvin, element</p>
<p><img alt="Image" src="../_images/VoigthKelvin.png" /></p>
<p>In this element the strain <span class="math notranslate nohighlight">\(\gamma\)</span> (displacement) are the same, and the stress <span class="math notranslate nohighlight">\(\tau\)</span> (forces) are additives</p>
<div class="math notranslate nohighlight">
\[ \gamma_1 = \gamma_2 = \gamma \]</div>
<div class="math notranslate nohighlight">
\[\tau = \tau_1 + \tau_2 = G\gamma + \eta \dot\gamma \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">eta</span><span class="p">,</span><span class="n">G</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;eta,G&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">)</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">)</span>
<span class="n">gammaDot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;gammaDot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">G</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">eta</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_60_0.png" src="../_images/rheology_60_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gammaSol</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">gamma</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="mi">0</span><span class="p">})</span>
<span class="n">gammaSol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_61_0.png" src="../_images/rheology_61_0.png" />
</div>
</div>
<p>In a <strong>creep experiment</strong>, a constant stress is applied and then the element is released</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span><span class="p">,</span><span class="n">tau0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t_1,tau_0&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gammaSolTau0</span> <span class="o">=</span> <span class="n">gammaSol</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">sp</span><span class="o">.</span><span class="n">Piecewise</span><span class="p">((</span><span class="n">tau0</span><span class="p">,</span><span class="n">t</span><span class="o">&lt;</span><span class="n">t1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">t1</span><span class="p">)))</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">gammaSolTau0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_63_0.png" src="../_images/rheology_63_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tc</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t_c&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gammaSolTau0</span> <span class="o">=</span> <span class="n">gammaSolTau0</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">G</span><span class="o">*</span><span class="n">tc</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">gammaSolTau0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_64_0.png" src="../_images/rheology_64_0.png" />
</div>
</div>
<div class="math notranslate nohighlight">
\[\xi(t) = \gamma(t) \frac{G}{\tau_0}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xi</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;xi&#39;</span><span class="p">)</span>
<span class="n">xiEq</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">gammaSolTau0</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tau0</span><span class="p">,</span><span class="n">G</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">xiEq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_66_0.png" src="../_images/rheology_66_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epsilon</span><span class="p">,</span><span class="n">epsilon1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;epsilon, epsilon_1&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">xiEq</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">epsilon</span><span class="p">),</span><span class="n">xiEq</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">tc</span><span class="o">*</span><span class="n">epsilon</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">tc</span><span class="o">*</span><span class="n">epsilon1</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">xiEq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_67_0.png" src="../_images/rheology_67_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xi_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">epsilon</span><span class="p">,</span><span class="n">epsilon1</span><span class="p">),</span><span class="n">xiEq</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">epsilon1</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">xi_values</span> <span class="o">=</span> <span class="n">xi_f</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">epsilon1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">xi_values</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\gamma\frac</span><span class="si">{G}</span><span class="s1">{\tau_0}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\frac</span><span class="si">{t}</span><span class="s1">{\lambda}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f3d3ec23400&gt;
</pre></div>
</div>
<img alt="../_images/rheology_71_1.png" src="../_images/rheology_71_1.png" />
</div>
</div>
<p>In this case, the characteristic time <span class="math notranslate nohighlight">\(\lambda = \frac{\eta}{G}\)</span> is called <strong>retardation time</strong>. This model describes the behavior of a viscoelastic solid.</p>
</div>
<div class="section" id="jeffreys-burger-element">
<h3>Jeffreys-Burger element<a class="headerlink" href="#jeffreys-burger-element" title="Permalink to this headline">¶</a></h3>
<p>However, Maxwell and Voight elements are not able to describe correctly real viscoelastic materials. The are several complex combinations of this elements, and the more usual is the Jeffreys (or Burger) element that replaces in the Maxwell element the spring by a Voight element.</p>
<p><img alt="Image" src="../_images/JeffreysBurger.png" /></p>
<p>Stress in both parts are the same</p>
<div class="math notranslate nohighlight">
\[
\tau = \eta_1 \dot\gamma_1
\]</div>
<div class="math notranslate nohighlight">
\[
\tau = G_2\gamma_2 + \eta_2\dot\gamma_2
\]</div>
<p>and, on the other side,</p>
<div class="math notranslate nohighlight">
\[
\gamma = \gamma_1 + \gamma_2
\]</div>
<div class="math notranslate nohighlight">
\[
\dot\gamma = \dot\gamma_1 + \dot\gamma_2
\]</div>
<p>By combining these equations, we can obtain</p>
<div class="math notranslate nohighlight">
\[ \tau + \lambda_1\dot\tau = \eta_0\left(\dot\gamma + \lambda_2\ddot\gamma\right)\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\lambda_1 = \frac{\eta_1+\eta_2}{G_2}\\
\eta_0 = \eta_1 \\
\lambda_2 = \frac{\eta_2}{G_2}
\end{split}\]</div>
<p>There is a viscosity <span class="math notranslate nohighlight">\(\eta_0\)</span> (or <span class="math notranslate nohighlight">\(\eta_1\)</span>), which is known as the viscosity of the fluid part (considered newtonian) and two characteristic times, $\lambda_1<span class="math notranslate nohighlight">\( and \)</span>\lambda_2$, which are the relaxation and the retardation times, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">eta1</span><span class="p">,</span><span class="n">eta2</span><span class="p">,</span><span class="n">G2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;eta_1,eta_2,G_2&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">)</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">eta1</span><span class="o">+</span><span class="n">eta2</span><span class="p">)</span><span class="o">/</span><span class="n">G2</span><span class="o">*</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">eta1</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">eta2</span><span class="o">/</span><span class="n">G2</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_78_0.png" src="../_images/rheology_78_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#tauInf = sp.symbols(&#39;\\tau_{-\infty}&#39;)</span>
<span class="c1">#tauSol = sp.dsolve(eq,tau(t),ics={tau(-sp.oo):tauInf})</span>
<span class="n">tauSol</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">tau</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tauSol</span> <span class="o">=</span> <span class="n">tauSol</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">tauSol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_80_0.png" src="../_images/rheology_80_0.png" />
</div>
</div>
<p>Again, first term can be neglected after a while</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tauSolInf</span><span class="o">=</span><span class="n">tauSol</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tauSol</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tauSolInf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/rheology_82_0.png" src="../_images/rheology_82_0.png" />
</div>
</div>
</div>
<div class="section" id="extension-to-vectorial-notation">
<h3>Extension to vectorial notation<a class="headerlink" href="#extension-to-vectorial-notation" title="Permalink to this headline">¶</a></h3>
<p>Maxwell model is written, in vector and tensor notation as</p>
<div class="math notranslate nohighlight">
\[ \boldsymbol{\tau} + \lambda \stackrel{\triangledown}{\boldsymbol{\tau}} = \eta \boldsymbol{\dot\gamma} = \eta \left(\nabla \boldsymbol{u} + \nabla \boldsymbol{u}^T \right) \]</div>
<p>where <span class="math notranslate nohighlight">\(\stackrel{\triangledown}{\boldsymbol{\tau}}\)</span> is the Upper Convective Time Derivative, defined as</p>
<div class="math notranslate nohighlight">
\[ \stackrel{\triangledown}{\boldsymbol{\tau}} = \dot{\boldsymbol{\tau}} - \nabla \boldsymbol{u}\cdot\boldsymbol{\tau} - \boldsymbol{\tau}\cdot \nabla \boldsymbol{u}^T \]</div>
<p>In a similar way, Jeffreys model is written as</p>
<div class="math notranslate nohighlight">
\[ \boldsymbol{\tau} + \lambda_1 \stackrel{\triangledown}{\boldsymbol{\tau}} = \eta \left( \boldsymbol{\dot\gamma} + \lambda_2 \stackrel{\triangledown}{\boldsymbol{\dot\gamma}}\right) \]</div>
<p>known as the <a class="reference external" href="https://en.wikipedia.org/wiki/Oldroyd-B_model"><strong>Oldroyd-B</strong> model</a></p>
</div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./2-Rheology"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../1-microFlows/Assignment1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Assignment 1. Computation of journal bearing</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="FDMViscoelastic.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Viscoelastic fluid in a pipe (Maxwell model)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Robert Castilla - UPC CATMech Terrassa<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>